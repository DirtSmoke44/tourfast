{% extends 'main/layout.html' %}
{% load static %}

{% block title %}Корзина{% endblock %}

{% block links %}
<link rel="stylesheet" href="{% static 'main/css/cart.css' %}">
{% endblock %}

{% block body %}

<!-- Видеофон -->
<video autoplay muted loop class="bg-video">
    <source src="{% static 'main/videos/mixkit-flying-over-the-water-of-a-beach-with-many-boats-5364-full-hd.mp4' %}" type="video/mp4">
    Ваш браузер не поддерживает видео.
</video>

<!-- Затемнение -->
<div class="overlay"></div>

{% if tours %}
<div class="cart-wrapper">
    <div class="cart-container">
        <h2>Ваши туры:</h2>

        <div class="tours-list">
            {% for tour in tours %}
            <div class="tour-card">
                <div class="tour-image-container">
                    <img src="{{ tour.photo.url }}" alt="{{ tour.title }}" class="tour-image">
                </div>
                <div class="tour-details">
                    <h3 class="tour-title">{{ tour.title }}</h3>
                    <p class="tour-info">Страна: {{ tour.country.name }}</p>
                    <p class="tour-info">Отель: {{ tour.hotel.name }}</p>
                    <p class="tour-price">{{ tour.price|floatformat:"-2" }} ₽</p>
                    <form action="{% url 'remove_from_cart' tour.id %}" method="get">
                        <button type="submit" class="remove-btn">Удалить тур</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="cart-actions">
            <form action="{% url 'tours_page' %}" method="get">
                <button type="submit" class="add-tour-btn">Добавить тур</button>
            </form>

            <div class="cart-summary">
                <div class="summary-row">
                    <span>Отель за сутки:</span>
                    <span class="summary-price">{{ hotel_price|floatformat:"-2" }} ₽</span>
                </div>
                <div class="summary-row">
                    <span>Стоимость тура:</span>
                    <span class="summary-price">{{ total_price|floatformat:"-2" }} ₽</span>
                </div>
                <div class="summary-row total-row">
                    <span>Всего:</span>
                    <span class="summary-price total-price">{{ total_price|floatformat:"-2" }} ₽</span>
                </div>
            </div>

            <div class="final-actions">
                <a href="{% url 'clear_cart' %}" class="clear-cart-btn">Очистить</a>
                <a href="{% url 'orderaccept_page' %}" class="checkout-btn">Оплатить</a>
            </div>
        </div>
    </div>
</div>
{% else %}

<div class="empty-cart">
    <p class="empty-cart-text">Корзина пуста</p>
    <a href="{% url 'tours_page' %}" class="add-tour-btn2">Добавить тур</a>
</div>

{% endif %}

{% endblock %}